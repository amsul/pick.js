<!doctype html>

<meta charset="utf-8">



<link rel="stylesheet" href="demos/styles/main.css">
<link rel="stylesheet" href="lib/less/shadow.base.css">
<link rel="stylesheet" href="lib/less/shadow.drop.css">
<link rel="stylesheet" href="lib/less/shadow.modal.css">
<link rel="stylesheet" href="lib/less/shadow.blob.css">

<body>

    <script src="demos/scripts/jquery.js"></script>
    <script src="demos/scripts/rainbow.js"></script>
    <script src="lib/legacy.js"></script>
    <script src="lib/shadow.js"></script>


    <header class="section">
        <div class="section__block section__block--scoped">
            <nav class="navigation navigation--header">
                <ul class="navigation__list">
                    <li class="navigation__item">
                        <a class="navigation__link" href="">Home</a>
                    </li><!--
                 --><li class="navigation__item">
                        <a class="navigation__link" href="demos">Demos</a>
                    </li><!--
                 --><li class="navigation__item">
                        <a class="navigation__link" href="docs">Docs</a>
                    </li><!--
                 --><li class="navigation__item">
                        <a class="navigation__link" href="https://github.com/amsul/shadow-ui">Github</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>


    
<section class="section">
    <div class="section__block section__block--scoped">

        <h1>Shadow UI v0.5.0</h1>
        <p>Create Shadow DOM based UI components, such as dropdowns, modals, popups, tooltips, blobs, etc.</p>

        <hr>

        <h3>Here’s a quick demo:</h3>

        <div class="grid grid--spaced">

            <div class="grid__column grid__column--third">
                
<div class="shadow shadow--dropdown">Dropdown</div>
<script>
    shadow.extend({
        name: 'dropdown',
        template: '<div class="ui-face ui-face--padded">This is a dropdown</div>'
    })
    $('.shadow--dropdown').shadow('dropdown')
</script>

            </div><!--

         --><div class="grid__column grid__column--third">
                
<div class="shadow shadow--modal">Modal</div>
<script>
    shadow.extend({
        name: 'modal',
        prefix: 'ui-modal',
        template: '<div class="ui-face ui-face--padded">This is a modal popup</div>'
    })
    $('.shadow--modal').shadow('modal')
</script>

            </div><!--

         --><div class="grid__column grid__column--third">
                
<style>
    .ui-drop--tooltip {
        font-size: .625em;
        -webkit-transform: none;
    }
        .ui-drop--tooltip .ui-drop__pointer {
            display: none;
        }
        .ui-drop--tooltip .ui-drop__holder {
            border-color: #000;
            background: #333;
            color: #fff;
            width: auto;
        }
            .ui-drop--tooltip .ui-drop__wrap {
                padding: 5px 8px;
            }
</style>
<div class="shadow shadow--tooltip" data-title="This is a title dropdown">Tooltip <small class="text-dim">(hover and wait a sec)</small></div>
<script>
    shadow.extend({
        name: 'tooltip',
        template: function() {
            return this.ui.$host.data('title')
        },
        klasses: {
            root: [ '', '--tooltip' ]
        },
        init: function() {

            var ui = this.ui,
                timeout = null

            // Turn off the default events to open the ui.
            ui.$host.off( 'click focusin' )

            // Bind our own hover events to open/close the ui with a delay.
            // If IE<=9 is not a concern, delayed CSS transitions would be better.
            ui.$host.on( 'mouseenter focusin', function() {
                clearTimeout( timeout )
                timeout = setTimeout( ui.open.bind( ui ), 1000 )
            }).on( 'mouseleave focusout', function() {
                setTimeout( ui.close.bind( ui ), 100 )
                clearTimeout( timeout )
            })
        }
    })
    $('.shadow--tooltip').shadow('tooltip')
</script>

            </div>

        </div> <!-- .grid -->

        <div class="grid grid--spaced">

            <div class="grid__column grid__column--half">
                
<input type="text" class="shadow shadow--input" value="Input extension">
<script>
    shadow.extend({
        name: 'input',
        template: '<div class="ui-face ui-face--padded">This is an input component extension</div>'
    })
    $('.shadow--input').shadow('input')
</script>

            </div><!--

         --><div class="grid__column grid__column--half">
                
<style>
    .ui-drop--calendar .ui-drop__holder {
        width: 300px;
    }
</style>

<input type="text" class="shadow shadow--input-date" value="Date input">
<script>

    // The constants.
    WEEKS_IN_CAL = 6
    DAYS_IN_WEEK = 7


    // Create the shadow extension.
    shadow.extend({
        name: 'input-date',

        dict: {
            select: [],
            highlight: [],
            today: null,
            view: null,
            min: -Infinity,
            max: Infinity
        },

        queue: {
            today: 'now create',
            highlight: 'navigate create',
            view: 'create viewset'
        },

        cascades: {
            // select: 'highlight', //(optional)
            highlight: 'view'
        },

        klasses: {
            root: [ '', '--calendar' ]
        },

        defaults: {

            // Months and weekdays.
            monthsFull: [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ],
            monthsShort: [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ],
            weekdaysFull: [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday' ],
            weekdaysShort: [ 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat' ],

            // Today and clear.
            today: 'Today',
            clear: 'Clear',

            // The format to show on the `input` element.
            format: 'd mmmm, yyyy',

            // Classes.
            klasses: shadow._.prefix( 'calendar', {

                table: 'table',

                header: 'header',

                navPrev: 'nav--prev',
                navNext: 'nav--next',
                navDisabled: 'nav--disabled',

                month: 'month',
                year: 'year',

                selectMonth: 'select--month',
                selectYear: 'select--year',

                weekdays: 'weekday',

                day: 'day',
                disabled: 'day--disabled',
                selected: 'day--selected',
                highlighted: 'day--highlighted',
                now: 'day--today',
                infocus: 'day--infocus',
                outfocus: 'day--outfocus',

                footer: 'footer',

                buttonClear: 'button--clear',
                buttonToday: 'button--today'
            })
        },

        init: function() {

            var component = this,
                ui = component.ui

            // Set the starting values.
            var today = component.update( 'today', component.now() )
            component.update( 'select', today )

            ui.on('set', function( event ) {
                if ( event.item == 'highlight' && event.options == 'nav' ) {
                    ui.render()
                }
            })
        },

        template: function() {

            var component = this,

                settings = component.ui.settings,

                dateView = component.fetch('view'),
                dateToday = component.fetch('today'),

                // Create the next/prev labels.
                labelNav = function( next ) {
                    return shadow._.node({
                        el: 'button',
                        content: ' ',
                        attrs: {
                            'data-action': 'highlight:' + (next ? 1 : -1) + ':nav'
                        }
                    })
                },

                // Create the month label.
                labelMonth = shadow._.node({
                    content: settings.monthsFull[ dateView.month ],
                    klass: settings.klasses.month
                }),

                // Create the year label.
                labelYear = shadow._.node({
                    content: dateView.year,
                    klass: settings.klasses.year
                }),

                // Create the table head with the weekdays.
                tableHead = shadow._.node({
                    el: 'thead',
                    content: shadow._.node({
                        el: 'tr',
                        content: function() {
                            var row = ''
                            for ( var count = 0; count < DAYS_IN_WEEK; count += 1 ) {
                                row += shadow._.node({
                                    el: 'th',
                                    content: settings.weekdaysShort[ count ]
                                })
                            }
                            return row
                        }
                    })
                }), //tableHead

                // Create the table body as a matrix of dates (7x6).
                tableBody = shadow._.node({
                    el: 'tbody',
                    content: function() {

                        var rows = [],
                            shiftWeekday = dateView.day - ( settings.firstDay ? 1 : 0 ),
                            createNodeDate = function ( dayOfCalendar ) {
                                var date = component.create([ dateView.year, dateView.month, dayOfCalendar ])
                                return '<td>' + shadow._.node({
                                    el: 'button',
                                    content: date.date,
                                    attrs: {
                                        'data-action': 'select:' + date.time,
                                        'tabindex': -1
                                    }
                                }) + '</td>'
                            }

                        // Go through the weeks and days to fill up the collection.
                        for ( var countWeek = 0; countWeek < WEEKS_IN_CAL; countWeek += 1 ) {

                            // Create a collection for this week’s days.
                            rows[ countWeek ] = []

                            // Go through the days in this week to fill up the collection.
                            for ( var countWeekday = 1; countWeekday <= DAYS_IN_WEEK; countWeekday += 1 ) {

                                // Calculate the days up to this week.
                                var countDay = countWeek * DAYS_IN_WEEK + countWeekday - shiftWeekday

                                // Create the day cells and add it to the collection.
                                rows[ countWeek ].push( createNodeDate( countDay ) )
                            }

                            // Create the week row and update the collection.
                            rows[ countWeek ] = shadow._.node({
                                el: 'tr',
                                content: rows[ countWeek ]
                            })
                        }

                        return rows.join('')
                    }
                }), //tableBody

                // Create the “today” button.
                buttonToday = shadow._.node({
                    el: 'button',
                    content: 'Today',
                    attrs: {
                        'data-action': 'select:' + dateToday.time
                    }
                }),

                // Create the “clear” button.
                buttonClear = shadow._.node({
                    el: 'button',
                    content: 'Clear',
                    attrs: {
                        'data-action': 'clear'
                    }
                })


            // Return the composed the calendar.
            return shadow._.node({
                content: [
                    shadow._.node({
                        content: [ labelNav(), labelNav(1), labelMonth, labelYear ]
                    }),
                    shadow._.node({
                        el: 'table',
                        content: [ tableHead, tableBody ]
                    }),
                    shadow._.node({
                        content: [ buttonToday, buttonClear ]
                    })
                ]
            })
        }, //template

        now: function() {
            return this.normalize( new Date() )
        },
        normalize: function( date ) {
            date.setHours(0,0,0,0)
            return date
        },
        navigate: function( value, options ) {
            if ( options == 'nav' ) {
                var dateView = this.fetch('view')
                value = [ dateView.year, dateView.month + value, 1 ]
            }
            return value
        },
        viewset: function( value, options ) {
            return this.create([ value.year, value.month, 1 ])
        },
        create: function( value, options ) {

            if ( shadow._.isDate( value ) ) {
                // silently pass through..
            }
            else if ( shadow._.isInteger( value ) ) {
                value = this.normalize( new Date( value ) )
            }
            else if ( $.isArray( value ) ) {
                value = new Date( value[0], value[1], value[2] )
            }

            return value instanceof ShadowDate ? value : new ShadowDate( value )
        }
    })
    var ui = $('.shadow--input-date').shadow('input-date').shadow('ui')
    function ShadowDate( value ) {
        this.year = value.getFullYear()
        this.month = value.getMonth()
        this.date = value.getDate()
        this.day = value.getDay()
        this.time = value.getTime()
        this.obj = value
    }
</script>

            </div>

        </div> <!-- .grid -->

        <div class="grid grid--spaced">
            <div class="grid__column">
                
<div class="shadow shadow--blob">Blob</div>
<script>
    shadow.extend({
        name: 'blob',
        prefix: 'ui-blob',
        template: '<div class="ui-face ui-face--padded">This is a blob of content</div>'
    })
    $('.shadow--blob').shadow('blob')
</script>

            </div>
        </div> <!-- .grid -->

    </div>
</section>




</body>

