/*!
 * Shadow UI v0.6.1-0, 2014/10/26
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/shadow-ui
 * Licensed under MIT
 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a,a.jQuery):"function"==typeof define&&define.amd?define([a,"jquery"],b):a.shadow=b(a,a.jQuery)}(this,function(a,b){"use strict";function c(a,d){if(!a)throw new ReferenceError("The `shadowName` is required to register a UI interface.");var e="Element";if(d=b.extend(!0,{},d),d.extend&&(e=d.extend,delete d.extend),e=y.casePascal(e),!y.isTypeOf(c[e],"object")||"Element"!=e&&!c.Element.isClassOf(c[e]))throw new ReferenceError("There is no shadow element named “"+y.caseDash(e)+"”.");if(d.name)throw new ReferenceError("The `name` property of the `shadowOptions` is reserved.");d.name=y.casePascal(a),c[e].extend(d)}function d(a,b,c){a.setAttribute(("role"==b?"":"aria-")+b,c)}function e(a,b){var c=""+a[b],d=c.match(/(\w+) *= *this/),e=d&&d[1]+"|"||"",f="(\\.(call|apply))?\\(",g=new RegExp("(?:"+e+"this)\\._super("+f+")");c.match(g)||console.warn("Overriding the base method `"+b+"` without calling `this._super()` within the method might cause unexpected results. Make sure this is the behavior you desire.\n",a)}function f(a,b,c){return function(){var d=this;d._super=a[b];var e=c.apply(d,arguments);return delete d._super,e}}function g(a,b){a=Array.isArray(a)?new Date(a[0],a[1],a[2]):new Date(a),b&&a.setDate(1);var c=new Date;return c.setUTCFullYear(a.getFullYear()),c.setUTCMonth(a.getMonth()),c.setUTCDate(a.getDate()),c.setUTCHours(a.getTimezoneOffset()/60,a.getTimezoneOffset()%60,0,0),c}function h(a){var b=a%10;return a-=b,Object.freeze({start:a,end:a+9,toString:function(){return this.start+" - "+this.end}})}function i(a){var b=a[0],c={};return[].slice.call(b.attributes).forEach(function(b){var d=b.name;if(d.match(/^data-ui-/)){var e=a.data(d.replace(/^data-/,""));d=d.replace(/^data-ui-/,""),d=y.caseCamel(d),c[d]=e}}),c}function j(a){var c=a.$el[0].nodeName;a.$host||c.match(/^INPUT$/)||y.define(a,"$host",a.$el),a.$host||(y.define(a,"$host",b("<div>")),a.$el.after(a.$host))}function k(a){var b=a.template;b&&("function"==typeof b&&(b=a.template()),a.$host.html(b))}function l(a,b,c){b&&b!==a&&(b.id||(b.id="host_"+c),y.aria(a,"owns",b.id))}function m(a,b,c){for(var d in c){var e="data-ui-"+y.caseDash(d),f=c[d];null==f||b.getNamedItem(e)||("object"==typeof f&&(f=JSON.stringify(f)),a.attr(e,f)),n(a,c,d)}}function n(a,c,d){var e=c[d];Object.defineProperty(c,d,{get:function(){return e},set:function(c){var f=e,g=b.Event("assign:"+d,{value:c,name:d});a.trigger(g);var h=g.isDefaultPrevented();h||(e=g.value,o(a,d,e));var i=b.Event("set:"+d,{value:h?c:e,previousValue:f,name:d});a.trigger(i)}})}function o(a,b,c){b="data-ui-"+y.caseDash(b),null==c?a.removeAttr(b):a.attr(b,"object"==typeof c?JSON.stringify(c):c)}function p(a,b){if(!b&&!a)return{};if(b=b||"",!a)throw new ReferenceError("No `classNames` were given to prefix.");var c=function(a){var c=b&&a&&!a.match(/^-/)?"__":"";return b+c+a};for(var d in a){var e=a[d];"string"==typeof e&&(a[d]=e.split(" ").map(c).join(" "))}return a}function q(a,b,c,d){if(!Array.isArray(d))throw new TypeError("A data element with multiple values expects it’s attribute value to be a collection.");var e=b.match(/.*(\{).*?(\|).*?(\}).*/);if(!e||e.length<3)throw new SyntaxError("The `formatMultiple` option is invalid.");var f=b.match(/(.*)\{(.*?)\|(.*?)\}(.*)/),g=f[1],h=f[2],i=f[3],j=f[4];return d=d.map(function(b,e){var f=0===e?g:e===d.length-1?i:h,k=e===d.length-1?j:"";return b=c&&Array.isArray(b)?r(a,c,b):a(b),f+b+k}),d.join("")}function r(a,b,c){var d=b.match(/.*(\{).*?(\}).*/);if(!d||d.length<2)throw new SyntaxError("The `formatRange` option is invalid.");var e=b.match(/(.*)\{(.*?)\}(.*)/),f=e[1],g=e[2],h=e[3];return c=c.map(function(b,d){var e=0===d?f:g,i=d===c.length-1?h:"";return e+a(b)+i}),c.join("")}function s(a,b){var c=new RegExp("(\\[[^\\[]*\\])|("+Object.keys(b).sort(function(a,b){return b>a?1:-1}).join("|")+")|(.)","g");return(a||"").split(c).reduce(function(a,c){if(c)if(c in b)a.push({f:c});else if(c.match(/^\[.*]$/))a.push(c.replace(/^\[(.*)]$/,"$1"));else{var d=a[a.length-1];"string"==typeof d?a[a.length-1]=d+c:a.push(c)}return a},[])}function t(a,b,c,d){var e=[];if(!d)return e;var f=function(b,d,f){var g=b;b=w(b,d);var h=x(b,f);return h?(b=b.replace(h,""),c&&(h=u(a,c,h)),"string"==typeof h&&(h=a(h)),e.push(h),b):g},g=b.match(/(.*)\{(.*?)\|(.*?)\}(.*)/),h=g[1],i=g[2],j=g[3],k=g[4],l=100;for(d=f(d,h,i);l&&d;){if(!--l)throw"Fell into an infinite loop..";var m=d;if(d=f(d,i,i),d===m&&(d=f(d,i,j)),d===m){d=f(d,j,k);break}}return d=f(d,j,k),e}function u(a,b,c){var d=[];if(!c)return d;var e=function(b){var e=b;b=a(b),d.push(b),"string"==typeof b&&(e=b),c=c.replace(e,"")},f=b.match(/(.*)\{(.*?)\}(.*)/),g=f[1],h=f[2],i=f[3];c=w(c,g);var j=x(c,h);return j?(e(j),c=w(c,h),j=x(c,i),j&&e(j),d):c}function v(a){return a.replace(/[\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function w(a,b){var c=a.match(new RegExp("^"+v(b)));return c&&(a=a.replace(c[0],"")),a}function x(a,b){var c=a.match(new RegExp("(.*?)"+(v(b)||"$")));return c&&c[1]}Object.defineProperty(c,"IS_DEBUGGING",{writable:!0,value:!0}),c.build=function(a,b,d){if(d=d||{},d.$el=a,b=y.casePascal(b),!(b in c&&c.Object.isClassOf(c[b])))throw new ReferenceError("There is no shadow UI registered by the name of `"+b+"`.");return c[b].create(d)},c.buildAll=function(a,d){var e=b('[data-ui="'+a+'"]');e.each(function(){c.build(b(this),a,d)})};var y=c._={noop:function(){},define:function(a,b,c){Object.defineProperty(a,b,{enumerable:!0,value:c})},caseCamel:function(a){var b=!0,c=a.split(/(?=[A-Z])|-|_/).map(function(a,c){return a?1===a.length?b?(b=!1,a):a.toLowerCase():(b=!0,(c?a[0].toUpperCase():a[0].toLowerCase())+a.slice(1)):""}),d=c[0];return c.length>1&&d[0].match(/[A-Z]/)&&(c[0]=d[0].toLowerCase()+d.slice(1)),c.join("")},casePascal:function(a){var b=!0,c=a.split(/(?=[A-Z])|-|_/).map(function(a){return a?1===a.length?b?(b=!1,a):a.toLowerCase():(b=!0,a[0].toUpperCase()+a.slice(1)):""});return c.join("")},caseDash:function(a){var b=!0,c=a.split(/(?=[A-Z])|-|_/).map(function(a,c){return a?1===a.length?b?(b=!1,(c?"-":"")+a.toLowerCase()):a.toLowerCase():(b=!0,(c?"-":"")+a[0].toLowerCase()+a.slice(1)):""});return c.join("")},isTypeOf:function(a,b){var c={}.toString.call(a).slice(8,-1).toLowerCase();return b?b===c:c},aria:function(a,c,e){if(b.isPlainObject(c))for(var f in c)d(a,f,c[f]);else d(a,c,e)},el:function(a,b){var c,d,e="div";if(a)"string"==typeof a?c=a:(a.name&&(e=a.name),a.klass&&(c=a.klass),a.attrs&&(d=a.attrs));else if(!(b instanceof Node))return document.createTextNode(b);var f=document.createElement(e);if(c&&(f.className=c),d)for(var g in d)f.setAttribute(g,d[g]);return null!=b&&(Array.isArray(b)||(b=[b]),b.forEach(function(a){a instanceof Node||(a=document.createTextNode(a)),f.appendChild(a)})),f},indexIn:function(a,b,c){if(!Array.isArray(a))throw new TypeError("The collection to search in must be an array.");c=c||function(a,b){return b===a};for(var d=0;d<a.length;d++){var e=a[d];if(c(b,e))return d}return-1},isWithin:function(a,b,c){return this.indexIn(a,b,c)>-1}};return c.Object=Object.create({},{name:{enumerable:!0,value:"Object"},create:{enumerable:!0,value:function(a){var b=this,d=Object.create(b);Object.defineProperties(d,{name:{value:y.caseCamel(b.name),enumerable:!0},create:{value:y.noop},extend:{value:y.noop}});for(var g in a)if(g in b){var h="function"==typeof b[g];c.IS_DEBUGGING&&h&&e(a,g);var i=a[g];h&&"function"==typeof i&&(i=f(b,g,i)),y.define(d,g,i)}else if(c.IS_DEBUGGING)throw new ReferenceError("The `"+g+"` property is not recognized by "+b+".");return d}},extend:{enumerable:!0,value:function(a){var d=this;if(!d.isClass())throw console.debug(d),new TypeError("Cannot extend a constructed object.");var g=Object.create(d);for(var h in a)if(a.hasOwnProperty(h)){if("_super"==h)throw new Error("The `_super` property is reserved to allow object method inheritance.");var i="function"==typeof d[h]&&d[h]!==Object[h];i&&e(a,h);var j=i&&"function"==typeof a[h]?f(d,h,a[h]):b.isPlainObject(d[h])&&b.isPlainObject(a[h])?b.extend({},d[h],a[h]):a[h];y.define(g,h,j)}if(!g.name.match(/^[A-Z]/))throw new TypeError("An object’s name must be PascalCased.");if(hasOwnProperty.call(c,g.name))throw new TypeError("An object by the name of “"+g.name+"” already exists.");return c[g.name]=g,g}},isClass:{enumerable:!0,value:function(){var a=this,b=Object.getPrototypeOf(a);return a===c.Object||!b.isPrototypeOf(a)}},isClassOf:{enumerable:!0,value:function(a){var b=this;if(y.isTypeOf(a,"object"))do if(a=Object.getPrototypeOf(a),b===a)return!0;while(a);return!1}},isInstanceOf:{enumerable:!0,value:function(a){return this.isClassOf.call(a,this)}},isPrototypeOf:{enumerable:!0,value:function(a){var b=this,c=Object.getPrototypeOf(a);return b===c&&a.name===y.caseCamel(c.name)}},toString:{enumerable:!0,value:function(){if(c.IS_DEBUGGING)return this.toFullString();var a=this,b=a.isClass(),d=b?"class":"object",e=b?a:Object.getPrototypeOf(a);return"{"+d+" "+e.name+"}"}},toFullString:{enumerable:!0,value:function(){var a=this,b=a.isClass(),c=b?"class":"object",d=[];b||(a=Object.getPrototypeOf(a));do d.push(a.name),a=Object.getPrototypeOf(a);while(a&&a.name);return"{"+c+" "+d.join(":")+"}"}}}),c.Object.extend({name:"Date",value:null,year:null,month:null,date:null,setToTheFirst:!1,create:function(a,b){if(!a)return this._super();a===!0?a=new Date:y.isTypeOf(a,"object")&&this.isPrototypeOf(a)&&(a=a.value);var c=this._super(b);a=g(a,c.setToTheFirst);var d=a.getUTCFullYear(),e=a.getUTCMonth(),f=a.getUTCDate(),i=a.getUTCDay(),j=a.getTime(),k=60*a.getTimezoneOffset()*1e3;return y.define(c,"value",[d,e,f]),y.define(c,"decade",h(d)),y.define(c,"year",d),y.define(c,"month",e),y.define(c,"date",f),y.define(c,"day",i),y.define(c,"time",j),y.define(c,"offset",k),c},compare:function(a,b){if(arguments.length<2&&(b=a,a=""),a=a||"time",!this.value||!b)return!1;c.Date.isClassOf(b)||(b=c.Date.create(b));var d=this,e=b;return a.match(/^decade ?/)?(d=d.decade.start,e=e.decade.start):a.match(/^year ?/)?(d=d.year,e=e.year):a.match(/^month ?/)?(d=new Date(d.year,d.month,1).getTime(),e=new Date(e.year,e.month,1).getTime()):a.match(/^date ?/)?(d=new Date(d.year,d.month,d.date).getTime(),e=new Date(e.year,e.month,e.date).getTime()):(d=d.time,e=e.time),a.match(/ ?greater equal$/)?d>=e:a.match(/ ?lesser equal$/)?e>=d:a.match(/ ?greater$/)?d>e:a.match(/ ?lesser$/)?e>d:d===e},compareRange:function(a,b){if(arguments.length<2&&(b=a,a=""),!Array.isArray(b))throw new Error("A range must be an array.");var c=this;if(!b.length||!c.value)return!1;if(a=a||"date",1===b.length)return c.compare(a,b[0]);if(b.length>2)throw new Error("A range cannot have more than 2 dates.");var d=b[0],e=b[1];return c.compare(a+" greater equal",d)&&c.compare(a+" lesser equal",e)},valueOf:function(){return this.time},toJSON:function(){return this.value}}),c.Object.extend({name:"Element",$el:null,$host:null,id:null,attrs:null,dict:null,classNames:null,classNamesPrefix:null,content:null,setup:null,template:null,create:function(a){var c=a.$el=a.$el instanceof jQuery?a.$el:b(a.$el);if(!c.length)throw new ReferenceError("No `$el` element found for “"+this.name+"”.");if(c.data("shadow.isBound"))return c.data("shadow.ui");c.data("shadow.isBound",!0),a.attrs=b.extend({},this.attrs,a.attrs,i(c)),a.dict=b.extend({},this.dict,a.dict),a.classNames=b.extend({},this.classNames,a.classNames);var d=this._super(a);c.data("shadow.ui",d),y.define(d,"id",d.name+Math.abs(~~(1+Math.random()*new Date*1e4))),d.$el.attr("data-ui")!=d.name&&d.$el.attr("data-ui",y.caseDash(d.name));var e=d.$el.contents().toArray(),f=document.createDocumentFragment();return e.forEach(function(a){f.appendChild(a)}),y.define(d,"content",f),y.define(d,"classNames",p(d.classNames,d.classNamesPrefix)),Object.seal(d.classNames),d.setup&&d.setup(),Object.freeze(d.dict),m(d.$el,c[0].attributes,d.attrs),Object.seal(d.attrs),j(d),k(d),l(c[0],d.$host&&d.$host[0],c[0].id||d.id),d},extend:function(){var a=this._super.apply(this,arguments);return c.buildAll(y.caseDash(a.name)),a},on:function(){var a=this;if(a.isClass())throw new TypeError("To bind an event callback, the element must first be constructed.");b.fn.on.apply(a.$el,arguments)},off:function(){var a=this;if(a.isClass())throw new TypeError("To unbind an event callback, the element must first be constructed.");b.fn.off.apply(a.$el,arguments)},get:function(a){return this.attrs[a]},set:function(a,b){var c=this;a in c.attrs&&(c.attrs[a]=b)},add:function(a,c,d){var e=this,f=e.attrs[a];if(!y.isWithin(f,c,d)){var g=f.length;f.splice(g,0,c);var h=b.Event("add:"+a,{value:f,unit:c,name:a});e.$el.trigger(h)}},remove:function(a,c,d){var e=this,f=e.attrs[a],g=y.indexIn(f,c,d);if(!(0>g)){f.splice(g,1);var h=b.Event("remove:"+a,{value:f,unit:c,name:a});e.$el.trigger(h)}}}),c.Element.extend({name:"DataElement",$input:null,attrs:{select:null,value:null,hiddenInput:null,allowMultiple:null,allowRange:null,format:null,formatMultiple:null,formatRange:null},formats:null,classNames:{input:"input"},setup:function(){var a=this,b=a.attrs;if(b.format&&!a.formats)throw new TypeError("The `formats` hash map is required.");b.allowMultiple&&!b.formatMultiple&&(b.formatMultiple="{, |, }"),b.allowRange&&!b.formatRange&&(b.formatRange="{ - }"),a.on("assign:allowMultiple."+a.id,function(a){a.value?(b.formatMultiple||(b.formatMultiple="{, |, }"),b.select&&!b.allowRange&&(b.select=[b.select])):b.select&&!b.allowRange&&(b.select=b.select[b.select.length-1])}),a.on("assign:allowRange."+a.id,function(a){a.value?(b.formatRange||(b.formatRange="{ - }"),b.select&&!b.allowMultiple&&(b.select=[b.select])):b.select&&!b.allowMultiple&&(b.select=b.select[b.select.length-1])}),a.on("set:select."+a.id,function(c){var d=c.value;b.value=d?a.format(d):""}),a.on("set:format."+a.id+" set:formatRange."+a.id+" set:formatMultiple."+a.id,function(){b.select&&(b.value=a.format(b.select))})},create:function(a){var d=this._super(a),e=d.attrs;if(d.formats){if(!e.format)throw new TypeError("The `format` attribute is required.");Object.seal(d.formats)}if(d.$input||("INPUT"==d.$el[0].nodeName?c._.define(d,"$input",d.$el):e.hiddenInput&&(c._.define(d,"$input",b("<input type=hidden>")),d.$el.after(d.$input))),d.$input){if("INPUT"!=d.$input[0].nodeName)throw new TypeError("To create a shadow input, the `$el` must be an input element.");d.$input.addClass(d.classNames.input),e.value&&d.$input.val(e.value);var f=d.$input.val();!e.value&&f&&(e.select=d.parse(f)),d.on("set:value."+d.id,function(a){d.$input[0].value=a.value})}if(e.value){var g=d.parse(e.value);g&&(e.select=g)}else e.select&&(e.value=d.format(e.select));return d},format:function(a){var b=this,c=b.formats,d=b.attrs,e=function(a){return c?s(d.format,c).map(function(d){return d.f?c[d.f].call(b,a):d}).join(""):"object"==typeof a?JSON.stringify(a):""+a};return d.allowMultiple===!0?q(e,d.formatMultiple,d.formatRange,a):d.allowRange===!0?r(e,d.formatRange,a):e(a)},parse:function(a){if("string"!=typeof a)throw new TypeError("The parser expects a string.");if(!a)return null;var b=this,c=b.attrs,d=function(a){if(b.formats){var c=b.parseUnit(a);a=c}try{a=JSON.parse(a)}catch(d){}return a};return c.allowMultiple===!0?t(d,c.formatMultiple,c.formatRange,a):c.allowRange===!0?u(d,c.formatRange,a):d(a)},parseUnit:function(a){var b=this,c=b.formats,d={};return c&&s(b.attrs.format,c).forEach(function(e){if(e.f){var f=c[e.f].call(b,a,!0);if(!a.match(new RegExp("^"+f)))throw new SyntaxError("The value parsed by the `"+e.f+"` formatting rule did not match the value being parsed.\nValue being parsed: “"+a+"”.\nValue parsed by rule: “"+f+"”.");a=a.slice(f.length),d[e.f]=f}else{var g=new RegExp("^"+e);if(!a.match(g))throw new SyntaxError("The formatting unit “"+e+"” did not match in the string “"+a+"”.");a=a.replace(g,"")}}),d},get:function(a,b){var c=this,d=c._super(a);return b=b||{},b.format&&(d=c.format(d,b)),d}}),c});
//# sourceMappingURL=shadow.min.map